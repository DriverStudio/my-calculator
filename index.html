<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:title" content="üíé PRISMA | 30+ –ü–æ–ª–µ–∑–Ω—ã—Ö –°–µ—Ä–≤–∏—Å–æ–≤">
    <meta property="title" content="PRISMA | 30+ –ü–æ–ª–µ–∑–Ω—ã—Ö –°–µ—Ä–≤–∏—Å–æ–≤">

    <meta property="og:description"
        content="–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã, –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã, —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã –∏ –∂–∏–∑–Ω–∏. BMI, ROAS, QR-–∫–æ–¥—ã, –ó–≤—É–∫–∏ –¥–ª—è —Ñ–æ–∫—É—Å–∞ –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ. –ë–µ—Å–ø–ª–∞—Ç–Ω–æ.">

    <meta property="og:image" content="https://driverstudio.github.io/my-calculator/assets/og-preview.png">

    <meta property="og:type" content="website">

    <meta property="og:url" content="https://driverstudio.github.io/my-calculator/">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="üíé PRISMA">
    <meta name="twitter:image" content="https://driverstudio.github.io/my-calculator/assets/og-preview.png">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <style>
        /* –°–µ—Ç–∫–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –ø—Ä–µ–∂–Ω–µ–π */
        .catalog-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px;
            width: 100%;
        }

        .tool-card {
            background: #fff;
            border: 1px solid #e9ecef;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            text-decoration: none;
            color: #333;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .tool-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.08);
            border-color: #28a745;
        }

        .tool-icon {
            font-size: 40px;
            margin-bottom: 5px;
        }

        .tool-name {
            font-weight: bold;
            font-size: 18px;
        }

        .tool-desc {
            font-size: 13px;
            color: #777;
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>

<body>
    <div class="container">
        <div style="width: 100%;">
            <h1 style="margin-bottom: 10px;" data-i18n="home.title">
                <img src="favicon.svg" class="logo-icon" alt="Logo">
                PRISMA
            </h1>
            <p style="margin-bottom: 30px; color: #666;" data-i18n="home.subtitle">
                –ö–æ–ª–ª–µ–∫—Ü–∏—è –∏–∑ 30 –ø–æ–ª–µ–∑–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –¥–ª—è —Ä–∞–±–æ—Ç—ã –∏ –∂–∏–∑–Ω–∏.
            </p>
            <input type="text" id="searchInput" class="search-box" placeholder="üîç –ù–∞–π—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç..."
                data-i18n="home.search_placeholder">
            <div id="ad-banner-top" class="ad-slot"></div>
            <div id="catalog-root"></div>
            <div id="noResults" style="display:none; text-align:center; padding: 40px; color:#777;"
                data-i18n="home.no_results">
                ü§∑‚Äç‚ôÇÔ∏è –ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.
            </div>
        </div>
    </div>
    <script src="main.js"></script>
    <script>
        const root = document.getElementById('catalog-root');
        const searchInput = document.getElementById('searchInput');
        const noResults = document.getElementById('noResults');

        // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–≤–æ–¥–∞ –Ω–∞–∑–≤–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        // –ü—ã—Ç–∞–µ—Ç—Å—è –Ω–∞–π—Ç–∏ –ø–µ—Ä–µ–≤–æ–¥ –≤ JSON –ø–æ –∫–ª—é—á—É app.id + ".title" (–∏–ª–∏ –∫–∞–∫ —É —Ç–µ–±—è –≤ JSON)
        // –ï—Å–ª–∏ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ app.name –∏–∑ main.js
        function getAppName(app) {
            if (window.I18N && window.I18N[currentLang] && window.I18N[currentLang][app.id]) {
                // –í —Ç–≤–æ–µ–º JSON –∫–ª—é—á–∏ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ, –ø–æ—ç—Ç–æ–º—É –±–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π –∫–ª—é—á –∏–∑ –æ–±—ä–µ–∫—Ç–∞ —Å–µ—Ä–≤–∏—Å–∞, 
                // –∫–æ—Ç–æ—Ä—ã–π –ø–æ—Ö–æ–∂ –Ω–∞ –∑–∞–≥–æ–ª–æ–≤–æ–∫, –ò–õ–ò –ø—Ä–æ—Å—Ç–æ –±–µ—Ä–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–∑ main.js, 
                // –µ—Å–ª–∏ JSON –¥–ª—è –∫–∞—Ç–∞–ª–æ–≥–∞ –µ—â–µ –Ω–µ –≥–æ—Ç–æ–≤.

                // –í–ê–†–ò–ê–ù–¢: –ï—Å–ª–∏ —Ç—ã –¥–æ–±–∞–≤–∏—à—å –≤ JSON –∫–ª—é—á "title" –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:
                // return window.I18N[currentLang][app.id]['title'] || app.name;

                // –ü–û–ö–ê –ß–¢–û (–¥–ª—è —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã): –û—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å, 
                // —Ç–∞–∫ –∫–∞–∫ –≤ —Ç–≤–æ–µ–º JSON –Ω–µ—Ç —á–∏—Å—Ç—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π —Å–µ—Ä–≤–∏—Å–æ–≤, —Ç–æ–ª—å–∫–æ –∫–ª—é—á–∏ –≤–Ω—É—Ç—Ä–∏ –Ω–∏—Ö.
                // –†–µ–∫–æ–º–µ–Ω–¥—É—é –¥–æ–±–∞–≤–∏—Ç—å –≤ JSON –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –∫–ª—é—á "_title": "–ù–∞–∑–≤–∞–Ω–∏–µ"

                const serviceData = window.I18N[currentLang][app.id];
                if (serviceData && serviceData['_title']) {
                    return serviceData['_title'];
                }
            }
            return app.name;
        }

        function getCategoryName(catKey) {
            if (window.I18N && window.I18N[currentLang] && window.I18N[currentLang]['categories']) {
                return window.I18N[currentLang]['categories'][catKey] || catKey;
            }
            // –§–æ–ª–ª–±—ç–∫, –µ—Å–ª–∏ JSON –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è
            const RU_CATS = {
                'finance': 'üí∞ –§–∏–Ω–∞–Ω—Å—ã', 'health': 'üíä –ó–¥–æ—Ä–æ–≤—å–µ',
                'work': 'üíª –†–∞–±–æ—Ç–∞ & IT', 'tools': 'üõ† –£—Ç–∏–ª–∏—Ç—ã', 'fun': 'üéÆ –†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è'
            };
            return RU_CATS[catKey] || '–†–∞–∑–Ω–æ–µ';
        }

        // === –û–ë–ù–û–í–õ–ï–ù–ù–´–ô RENDER CATALOG ===
        window.renderCatalog = function () {
            const root = document.getElementById('catalog-root');
            root.innerHTML = '';

            const uniqueCats = [...new Set(APPS.map(app => app.category))];

            uniqueCats.forEach(catKey => {
                const section = document.createElement('div');
                section.className = 'category-section';
                // ... —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ (–æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –±—ã–ª–æ) ...
                const title = document.createElement('div');
                title.className = 'category-title';
                title.innerText = getCategoryName(catKey);
                section.appendChild(title);

                const grid = document.createElement('div');
                grid.className = 'catalog-grid';

                const catApps = APPS.filter(app => app.category === catKey);

                catApps.forEach(app => {
                    const card = document.createElement('a');
                    card.className = 'tool-card';
                    card.style.position = 'relative';
                    card.href = `./${app.id}/index.html`;

                    const localizedName = getAppName(app);
                    // ... (I18N –ª–æ–≥–∏–∫–∞, –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –±—ã–ª–æ) ...
                    let openText = '–û—Ç–∫—Ä—ã—Ç—å ‚Üí';
                    if (window.I18N && window.I18N[currentLang] && window.I18N[currentLang]['home']) {
                        openText = window.I18N[currentLang]['home']['open_btn'];
                    }

                    card.setAttribute('data-keywords', `${localizedName} ${app.name} ${app.id}`.toLowerCase());

                    card.innerHTML = `
                <div class="tool-icon">${app.icon}</div>
                <div class="tool-name">${localizedName}</div>
                <div class="tool-desc">${openText}</div>
            `;

                    // === –ú–ê–ì–ò–Ø: –ü–†–û–í–ï–†–ö–ê –ù–ê–õ–ò–ß–ò–Ø –ü–†–ï–í–¨–Æ ===
                    // –ú—ã –≤—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è —Å–∞–º–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∏ –¥–æ–±–∞–≤–∏—Ç –∫–Ω–æ–ø–∫—É, –µ—Å–ª–∏ –Ω–∞–π–¥–µ—Ç
                    tryAddPreviewButton(card, app);

                    grid.appendChild(card);
                });

                section.appendChild(grid);
                root.appendChild(section);
            });

            if (typeof initSpotlight === 'function') initSpotlight();
        };


        // === –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò –ü–†–ï–í–¨–Æ (UPDATED) ===

        /**
         * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –º–µ–¥–∏–∞ (–≤–∏–¥–µ–æ mp4 -> gif -> png -> jpg)
         */
        function tryAddPreviewButton(cardElement, app) {
            // –î–æ–±–∞–≤–∏–ª–∏ 'mp4' –∏ 'webm' –≤ –Ω–∞—á–∞–ª–æ —Å–ø–∏—Å–∫–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤
            const formats = ['mp4', 'webm', 'gif', 'png', 'jpg', 'jpeg'];
            let formatIndex = 0;

            function checkNextFormat() {
                if (formatIndex >= formats.length) return;

                const ext = formats[formatIndex];
                const src = `assets/previews/${app.id}.${ext}`;

                // –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ–º Image –¥–∞–∂–µ –¥–ª—è –≤–∏–¥–µ–æ (—Ç—Ä—é–∫)
                // –õ–∏–±–æ fetch (–Ω–∞–¥–µ–∂–Ω–µ–µ), –Ω–æ Image –±—ã—Å—Ç—Ä–µ–µ –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–æ–∫.
                // –î–ª—è –≤–∏–¥–µ–æ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å fetch HEAD –∑–∞–ø—Ä–æ—Å, –Ω–æ —á—Ç–æ–±—ã –Ω–µ —É—Å–ª–æ–∂–Ω—è—Ç—å –∫–æ–¥,
                // –ø–æ–ø—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–∞–∫ Image. –ï—Å–ª–∏ —ç—Ç–æ –≤–∏–¥–µ–æ, image.onerror —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ –≤—Å–µ–≥–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.
                // –ü–û–≠–¢–û–ú–£: –ò—Å–ø–æ–ª—å–∑—É–µ–º fetch –¥–ª—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç–∏.

                fetch(src, { method: 'HEAD' })
                    .then(res => {
                        if (res.ok) {
                            // –§–∞–π–ª –µ—Å—Ç—å!
                            createHelpButton(cardElement, app, src, ext);
                        } else {
                            throw new Error('Not found');
                        }
                    })
                    .catch(() => {
                        formatIndex++;
                        checkNextFormat();
                    });
            }

            checkNextFormat();
        }

        /**
         * –°–æ–∑–¥–∞–µ—Ç –∫–Ω–æ–ø–∫—É (–ø–µ—Ä–µ–¥–∞–µ–º —Ç–µ–ø–µ—Ä—å –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)
         */
        function createHelpButton(card, app, src, ext) {
            const helpBtn = document.createElement('div');
            helpBtn.className = 'card-help-btn';
            helpBtn.innerText = (ext === 'mp4' || ext === 'webm') ? '‚ñ∂' : '?'; // –ò–∫–æ–Ω–∫–∞ Play –¥–ª—è –≤–∏–¥–µ–æ
            helpBtn.style.display = 'flex';

            helpBtn.onclick = (e) => {
                e.preventDefault();
                e.stopPropagation();
                openPreview(app, src, ext);
            };

            card.appendChild(helpBtn);
        }

        // === –õ–û–ì–ò–ö–ê –û–¢–ö–†–´–¢–ò–Ø –û–ö–ù–ê (–° –ê–î–ê–ü–¢–ê–¶–ò–ï–ô) ===
        function openPreview(app, src, ext) {
            const overlay = document.getElementById('preview-overlay');
            const card = overlay.querySelector('.tour-card');

            // –≠–ª–µ–º–µ–Ω—Ç—ã
            const imgEl = document.getElementById('preview-img');
            const videoEl = document.getElementById('preview-video');

            // –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è
            imgEl.style.display = 'none';
            videoEl.style.display = 'none';
            videoEl.pause();
            imgEl.src = "";
            videoEl.src = "";

            // –°–±—Ä–æ—Å –∫–ª–∞—Å—Å–æ–≤ –º–∞–∫–µ—Ç–∞ (–≤–æ–∑–≤—Ä–∞—Ç –∫ –¥–µ—Ñ–æ–ª—Ç—É - row)
            card.classList.remove('vertical-layout');

            // –î–∞–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç–æ–≤
            document.getElementById('preview-icon').innerText = app.icon;
            document.getElementById('preview-title').innerText = getAppName(app);

            let descText = `–ö—Ä–∞—Ç–∫–∏–π –æ–±–∑–æ—Ä —Å–µ—Ä–≤–∏—Å–∞ ${app.name}.`;
            if (window.I18N && window.I18N[currentLang] && window.I18N[currentLang][app.id]) {
                const data = window.I18N[currentLang][app.id];
                descText = data.desc || data.subtitle || descText;
            }
            document.getElementById('preview-desc').innerText = descText;


            // === –£–ú–ù–ê–Ø –õ–û–ì–ò–ö–ê –û–¢–û–ë–†–ê–ñ–ï–ù–ò–Ø ===
            const isVideo = (ext === 'mp4' || ext === 'webm');

            if (isVideo) {
                videoEl.style.display = 'block';
                videoEl.src = src;

                // –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å —Ä–∞–∑–º–µ—Ä—ã
                videoEl.onloadedmetadata = () => {
                    adjustLayout(card, videoEl.videoWidth, videoEl.videoHeight);
                };
            } else {
                imgEl.style.display = 'block';
                imgEl.src = src;

                // –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏
                imgEl.onload = () => {
                    adjustLayout(card, imgEl.naturalWidth, imgEl.naturalHeight);
                };
            }

            // –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞
            document.getElementById('preview-open-btn').onclick = () => {
                window.location.href = `./${app.id}/index.html`;
            };

            overlay.classList.remove('hidden');
            requestAnimationFrame(() => overlay.classList.add('active'));
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–∞–∫–µ—Ç–∞
        function adjustLayout(cardElement, width, height) {
            console.log(`Media size: ${width}x${height}`);

            // –ï—Å–ª–∏ –®–∏—Ä–∏–Ω–∞ > –í—ã—Å–æ—Ç—ã (–®–∏—Ä–æ–∫–æ–µ) -> –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å—Ç–µ–∫ (–í–∏–¥–µ–æ —Å–Ω–∏–∑—É)
            // –î–æ–±–∞–≤–∏–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç 1.2, —á—Ç–æ–±—ã –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ –≤–∏–¥–µ–æ —Ç–æ–∂–µ —à–ª–∏ –≤–ø—Ä–∞–≤–æ (–∫–∞–∫ –≤—ã—Å–æ–∫–∏–µ)
            if (width > height * 1.2) {
                cardElement.classList.add('vertical-layout');
            } else {
                // –í—ã—Å–æ–∫–æ–µ –∏–ª–∏ –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–µ -> –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Ä—è–¥ (–í–∏–¥–µ–æ —Å–ø—Ä–∞–≤–∞)
                cardElement.classList.remove('vertical-layout');
            }
        }

        function closePreview() {
            const overlay = document.getElementById('preview-overlay');
            overlay.classList.remove('active');
            setTimeout(() => overlay.classList.add('hidden'), 500);
        }

        // –ñ–∏–≤–æ–π –ø–æ–∏—Å–∫
        searchInput.addEventListener('input', function () {
            const query = this.value.toLowerCase().trim();
            const cards = document.querySelectorAll('.tool-card');
            const sections = document.querySelectorAll('.category-section');
            let totalVisible = 0;

            cards.forEach(card => {
                const keywords = card.getAttribute('data-keywords');
                if (query === '' || keywords.includes(query)) {
                    card.classList.remove('hidden');
                } else {
                    card.classList.add('hidden');
                }
            });

            sections.forEach(section => {
                const visibleCards = section.querySelectorAll('.tool-card:not(.hidden)');
                if (visibleCards.length > 0) {
                    section.classList.remove('hidden');
                    totalVisible++;
                } else {
                    section.classList.add('hidden');
                }
            });

            noResults.style.display = totalVisible === 0 ? 'block' : 'none';
        });

        // –ü–µ—Ä–≤–∏—á–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä (–µ—Å–ª–∏ –ø–µ—Ä–µ–≤–æ–¥—ã –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å, –æ—Ç—Ä–∏—Å—É–µ—Ç –¥–µ—Ñ–æ–ª—Ç, 
        // –∞ –ø–æ—Ç–æ–º initTranslations –≤—ã–∑–æ–≤–µ—Ç renderCatalog –µ—â–µ —Ä–∞–∑)
        renderCatalog();

        // === PRISMA TOUR LOGIC ===

        const TOUR_SLIDES = [
            {
                title: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ PRISMA",
                text: "–≠—Ç–æ –≤–∞—à–∞ –Ω–æ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –≤—Å–µ–≥–¥–∞.",
                icon: "üíé",
                action: () => {
                    // –ß–∏—Å—Ç–∫–∞ –ø–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º
                    cleanUpTour();
                }
            },
            {
                title: "–£–º–Ω—ã–π –ü–æ–∏—Å–∫",
                text: "–í–≤–µ–¥–∏—Ç–µ 'BMI', 'QR' –∏–ª–∏ 'ROAS'. –ú—ã –Ω–∞–π–¥–µ–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ.",
                icon: "üîç",
                action: () => {
                    cleanUpTour(); // –°–±—Ä–æ—Å –ø—Ä–æ—à–ª—ã—Ö —à–∞–≥–æ–≤

                    const search = document.getElementById('searchInput');
                    const container = document.querySelector('.container');
                    // 1. –ü–æ–¥–Ω–∏–º–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–†–æ–¥–∏—Ç–µ–ª—è)
                    container.classList.add('tour-parent-fix');
                    // 2. –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –ø–æ–∏—Å–∫
                    search.classList.add('tour-highlight');

                    search.focus();
                    search.value = "Cryp";
                    search.dispatchEvent(new Event('input'));

                    setTimeout(() => {
                        search.value = "";
                        search.dispatchEvent(new Event('input'));
                    }, 1500);
                }
            },
            {
                title: "–¢—ë–º–Ω–∞—è —Ç–µ–º–∞",
                text: "–ö–ª–∏–∫–Ω–∏—Ç–µ –æ–¥–∏–Ω —Ä–∞–∑, —á—Ç–æ–±—ã —Å–±–µ—Ä–µ—á—å –∑—Ä–µ–Ω–∏–µ –Ω–æ—á—å—é.",
                icon: "üåó",
                action: () => {
                    cleanUpTour();

                    const themeBtn = document.getElementById('themeBtn');
                    // –ü–æ—Å–∫–æ–ª—å–∫—É –∫–Ω–æ–ø–∫–∞ –≤ –Ω–∞–≤–±–∞—Ä–µ (fixed), –µ–π –Ω–µ –Ω—É–∂–µ–Ω fix –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
                    // –ù–æ —É –Ω–∞–≤–±–∞—Ä–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å z-index –≤—ã—à–µ –æ–≤–µ—Ä–ª–µ—è.
                    // –ï—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ –Ω–µ —Å–≤–µ—Ç–∏—Ç—Å—è, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å z-index –Ω–∞–≤–±–∞—Ä—É.
                    document.querySelector('.nav-bar').style.zIndex = '10005';
                    themeBtn.classList.add('tour-highlight');

                    // –ü–†–û–°–¢–û –ü–ï–†–ï–ö–õ–Æ–ß–ê–ï–ú (–¢—É–∫-—Ç—É–∫)
                    toggleTheme(); // –°—Ç–∞–Ω–µ—Ç —Å–≤–µ—Ç–ª–æ–π (—Ä–∞–∑ –±—ã–ª–∞ —Ç–µ–º–Ω–æ–π)

                    setTimeout(() => {
                        toggleTheme(); // –í–µ—Ä–Ω–µ–º –∫–∞–∫ –±—ã–ª–æ —á–µ—Ä–µ–∑ 1.5 —Å–µ–∫
                    }, 1500);
                }
            },
            {
                title: "–í—Å—ë –≥–æ—Ç–æ–≤–æ!",
                text: "–í—ã –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞–±–æ—Ç–µ. –ü–æ–ª—å–∑—É–π—Ç–µ—Å—å!",
                icon: "üöÄ",
                action: () => {
                    cleanUpTour();
                    // –°–∞–ª—é—Ç, –µ—Å–ª–∏ –∑–∞—Ö–æ—á–µ—à—å
                }
            }
        ];

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ—á–∏—Å—Ç–∫–∏ (—á—Ç–æ–±—ã –Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥)
        function cleanUpTour() {
            document.querySelectorAll('.tour-highlight').forEach(el => el.classList.remove('tour-highlight'));
            document.querySelectorAll('.tour-parent-fix').forEach(el => el.classList.remove('tour-parent-fix'));

            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º z-index –Ω–∞–≤–±–∞—Ä—É –∫–∞–∫ –±—ã–ª–æ
            const nav = document.querySelector('.nav-bar');
            if (nav) nav.style.zIndex = '';

            // –°–∫—Ä–æ–ª–ª –Ω–∞–≤–µ—Ä—Ö
            // window.scrollTo({top: 0, behavior: 'smooth'});
        }

        let currentSlide = 0;

        function initTour() {
            // –ï—Å–ª–∏ —É–∂–µ —Å–º–æ—Ç—Ä–µ–ª–∏ - –≤—ã—Ö–æ–¥–∏–º
            if (localStorage.getItem('prisma_tour_completed')) return;
            startTour();
        }

        // –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
        window.startTour = function () {
            const overlay = document.getElementById('tour-overlay');
            const btn = document.getElementById('tour-btn');
            const dotsContainer = document.getElementById('tour-dots');

            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–ª–∞–π–¥ –Ω–∞ –Ω–∞—á–∞–ª–æ
            currentSlide = 0;

            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ç–æ—á–∫–∏
            dotsContainer.innerHTML = '';
            TOUR_SLIDES.forEach((_, i) => {
                const dot = document.createElement('div');
                dot.className = `tour-dot ${i === 0 ? 'active' : ''}`;
                dotsContainer.appendChild(dot);
            });

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–≤–µ—Ä–ª–µ–π
            overlay.classList.remove('hidden');
            // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
            requestAnimationFrame(() => {
                overlay.classList.add('active');
            });

            renderSlide(0);
            btn.onclick = nextSlide;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–∑–æ–≤–∞ –ø–æ –∫–Ω–æ–ø–∫–µ (—Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç –ø–∞–º—è—Ç—å)
        window.restartTour = function () {
            // –£–¥–∞–ª—è–µ–º –º–µ—Ç–∫—É "–ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ"
            localStorage.removeItem('prisma_tour_completed');
            // –ó–∞–ø—É—Å–∫–∞–µ–º
            startTour();
        }

        function renderSlide(index) {
            const slide = TOUR_SLIDES[index];

            // –ê–Ω–∏–º–∞—Ü–∏—è —Å–º–µ–Ω—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            const card = document.querySelector('.tour-card');

            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç—ã
            document.getElementById('tour-visual').innerText = slide.icon;
            document.getElementById('tour-title').innerText = slide.title;
            document.getElementById('tour-desc').innerText = slide.text;

            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É
            const btn = document.getElementById('tour-btn');
            btn.innerText = index === TOUR_SLIDES.length - 1 ? "–ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É" : "–î–∞–ª–µ–µ ‚Üí";

            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ—á–∫–∏
            document.querySelectorAll('.tour-dot').forEach((d, i) => {
                d.classList.toggle('active', i === index);
            });

            // –ó–∞–ø—É—Å–∫–∞–µ–º —ç–∫—à–Ω —Å–ª–∞–π–¥–∞ (–ø–æ–¥—Å–≤–µ—Ç–∫–∞, –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã –∏ —Ç.–¥.)
            if (slide.action) slide.action();
        }

        function nextSlide() {
            if (currentSlide < TOUR_SLIDES.length - 1) {
                currentSlide++;
                renderSlide(currentSlide);
            } else {
                endTour();
            }
        }

        function endTour() {
            const overlay = document.getElementById('tour-overlay');
            overlay.classList.remove('active');
            setTimeout(() => overlay.classList.add('hidden'), 500);

            // –£–±–∏—Ä–∞–µ–º –≤—Å–µ –ø–æ–¥—Å–≤–µ—Ç–∫–∏
            document.querySelectorAll('.tour-highlight').forEach(el => el.classList.remove('tour-highlight'));

            // –ó–∞–ø–æ–º–∏–Ω–∞–µ–º, —á—Ç–æ —é–∑–µ—Ä –ø—Ä–æ—à–µ–ª –æ–±—É—á–µ–Ω–∏–µ
            localStorage.setItem('prisma_tour_completed', 'true');
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', () => {
            // –î–∞–µ–º —Å–∞–π—Ç—É –ø—Ä–æ–≥—Ä—É–∑–∏—Ç—å—Å—è —Å–µ–∫—É–Ω–¥—É, –ø–æ—Ç–æ–º —Å—Ç–∞—Ä—Ç—É–µ–º —Ç—É—Ä
            setTimeout(initTour, 1000);
        });

    </script>

    <div id="tour-overlay" class="tour-overlay hidden">
        <div class="tour-card">
            <div class="tour-visual" id="tour-visual">
                üíé
            </div>
            <h2 id="tour-title" class="tour-title">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å</h2>
            <p id="tour-desc" class="tour-desc">
                Prisma ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –Ω–∞–±–æ—Ä —Å—Å—ã–ª–æ–∫. –≠—Ç–æ –≤–∞—à–∞ –Ω–æ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ.
            </p>

            <div class="tour-controls">
                <div class="tour-dots" id="tour-dots">
                </div>
                <button id="tour-btn" class="tour-btn">–î–∞–ª–µ–µ ‚Üí</button>
            </div>

            <div class="tour-skip" onclick="endTour()">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ</div>
        </div>
    </div>

    <div id="preview-overlay" class="tour-overlay hidden">
        <div class="tour-card preview-mode" style="width: 800px; max-width: 95%;">

            <div class="preview-text-side">
                <div class="tour-visual" id="preview-icon"
                    style="height: auto; font-size: 40px; margin-bottom: 15px; justify-content: flex-start;">
                    üíé
                </div>
                <h2 id="preview-title" class="tour-title">–ó–∞–≥–æ–ª–æ–≤–æ–∫</h2>
                <p id="preview-desc" class="tour-desc">
                    –û–ø–∏—Å–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞...
                </p>

                <div style="margin-top: auto;"> <button id="preview-open-btn" class="tour-btn"
                        style="width: 100% !important;">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å ‚Üí</button>
                    <div class="tour-skip" onclick="closePreview()" style="margin-top: 15px; text-align: center;">
                        –ó–∞–∫—Ä—ã—Ç—å</div>
                </div>
            </div>

            <div class="preview-media-side" id="preview-media-container">
                <img id="preview-img" src="" class="preview-full-img" alt="Preview" style="display: none;">

                <video id="preview-video" class="preview-full-img" controls autoplay loop muted playsinline
                    style="display: none;"></video>
            </div>

        </div>
    </div>

</body>


</html>